!function(a){function b(a,b,c){var b=void 0===b?"/images/ajax-loader.gif":b,c=void 0!==c?c:"";return this.elem=a,this.image='<img class="gfspinner" src="'+b+'" style="'+c+'" />',this.init=function(){return this.spinner=jQuery(this.image),jQuery(this.elem).after(this.spinner),this},this.destroy=function(){jQuery(this.spinner).remove()},this.init()}window.GFChainedSelects=function(c,d,e,f){var g=this;g.formId=c,g.fieldId=d,g.hideInactive=e,g.alignment=f;var h=a("#field_"+g.formId+"_"+g.fieldId);g.$selects=h.find("select"),g.$complete=h.find(".gf_chain_complete"),g.isDoingConditionalLogic=!1,g.init=function(){gform.addAction("gform_input_change",function(b,c,d){if(-1!=g.$selects.index(b)){var e=a(b).attr("name").split("_")[1];g.populateNextChoices(e,b.value,a(b))}},9),g.$selects.filter(function(){var b=a(this);return b.hasClass("gf_no_options")||b.find("option").length<=1}).toggleSelect(!0,g.hideInactive),gform.addFilter("gform_is_value_match",function(a,b,c){return g.isValueMatch(a,b,c)})},g.populateNextChoices=function(c,d,e){var f=g.getNextInputId(c),h=g.$selects.filter('[name="input_'+f+'"]');if(h.length<=0)return g.resetSelects(e,!0),void g.resizeSelects();if(g.resetSelects(e),d){if(g.hideInactive)var i=a('[name="input_'+c+'" ]'),j=new b(i,gformChainedSelectData.spinner,"display:inline-block;vertical-align:middle;margin:-1px 0 0 6px;");else{var k=a('<option value="">'+gformChainedSelectData.strings.loading+"...</option>"),l=2,m=setInterval(function(){k.text(gformChainedSelectData.strings.loading+new Array(l).join(".")),l=l>3?0:l+1},250);k.prependTo(h).prop("selected",!0),h.css({minWidth:h.width()}),k.text(gformChainedSelectData.strings.loading+".")}a.post(gformChainedSelectData.ajaxUrl,{action:"gform_get_next_chained_select_choices",input_id:c,form_id:g.formId,field_id:g.fieldId,value:g.getChainedSelectsValue(),nonce:gformChainedSelectData.nonce},function(b){if(g.hideInactive?j.destroy():(clearInterval(m),k.remove()),b){var c=a.parseJSON(b),d="";if(h.find("option:not(:first)").remove(),c.length<=0)g.resetSelects(e,!0);else if(a.each(c,function(a,b){d+='<option value="'+b.value+'">'+b.text+"</option>"}),h.show().append(d),c[0].noOptions){var f=h.find("option:last-child").clone(),i=h.parents("span").nextAll().find("select");i.append(f),i.add(h).addClass("gf_no_options").find("option:last-child").prop("selected",!0)}else h.removeClass("gf_no_options").toggleSelect(!1,g);g.resizeSelects()}})}},g.getChainedSelectsValue=function(){var b={};return g.$selects.each(function(){var c=a(this).attr("name").split("_")[1];b[c]=a(this).val()}),b},g.getNextInputId=function(a){var b=parseInt(a.split(".")[1]),c=b+1;return c%10==0&&c++,parseInt(a)+"."+c},g.resetSelects=function(a,b){var c=g.$selects.index(a);g.$selects.filter(":gt("+c+")").toggleSelect(!0,g.hideInactive).find("option:not(:first)").remove().val("").change()},g.resizeSelects=function(){if("vertical"==g.alignment){g.$selects.width("auto");var b=0;g.$selects.each(function(){a(this).width()>b&&(b=a(this).width())}),g.$selects.width(b+"px")}},g.toggleCompleted=function(a){a?g.$complete.fadeIn():g.$complete.fadeOut()},g.isValueMatch=function(b,c,d){if(d.fieldId!=g.fieldId||g.isDoingConditionalLogic)return b;g.isDoingConditionalLogic=!0,d=a.extend({},d);for(var e=g.getChainedSelectsValue(),f=Object.keys(e).map(function(a){return e[a]}),h=d.value.split("/"),i=0;i<h.length;i++)"*"==h[i]&&(h[i]=f[i]);return h=h.join("/"),f=f.join("/"),b=gf_matches_operation(h,f,d.operator),g.isDoingConditionalLogic=!1,b},a.fn.toggleSelect=function(a,b){return this.prop("disabled",a),void 0!==b&&b&&(a?this.hide():this.show()),this},g.init()}}(jQuery);